<!DOCTYPE html>
<html>
<head>
    <title>按钮调试</title>
    <style>
        body { padding: 20px; font-family: Arial; }
        .log { background: #f0f0f0; padding: 10px; margin: 10px 0; height: 200px; overflow-y: scroll; }
        button { background: #3b82f6; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
    </style>
</head>
<body>
    <h1>认知考古系统 - 按钮调试</h1>
    
    <h2>请在主页面执行以下步骤：</h2>
    <ol>
        <li>打开 http://localhost:3000/cognitive-archaeology</li>
        <li>按 F12 打开浏览器控制台</li>
        <li>在控制台输入以下调试代码：</li>
    </ol>

    <pre style="background: #1a1a1a; color: white; padding: 20px; border-radius: 8px;">
// 调试代码 - 复制到浏览器控制台

// 1. 查找按钮
const buttons = document.querySelectorAll('button');
console.log('找到按钮数量:', buttons.length);

// 2. 检查每个按钮
buttons.forEach((btn, index) => {
    console.log(`按钮 ${index}:`, {
        text: btn.textContent,
        disabled: btn.disabled,
        onclick: btn.onclick,
        className: btn.className
    });
    
    // 3. 为每个按钮添加测试点击
    btn.addEventListener('click', () => {
        console.log(`按钮 ${index} 被点击了！`);
    });
});

// 4. 查找输入框
const textarea = document.querySelector('textarea');
if (textarea) {
    console.log('找到输入框');
    textarea.value = '测试消息';
    console.log('已填充测试消息');
}

// 5. 查找发送按钮（包含SVG的按钮）
const sendButton = Array.from(buttons).find(btn => btn.querySelector('svg'));
if (sendButton) {
    console.log('找到发送按钮:', sendButton);
    console.log('按钮禁用状态:', sendButton.disabled);
    
    // 强制启用按钮
    sendButton.disabled = false;
    console.log('已强制启用按钮');
    
    // 模拟点击
    console.log('3秒后将模拟点击...');
    setTimeout(() => {
        console.log('模拟点击发送按钮');
        sendButton.click();
    }, 3000);
}
    </pre>

    <h3>或者使用这个自动测试：</h3>
    <button onclick="runAutoTest()">运行自动测试</button>
    <div class="log" id="log"></div>

    <script>
        function log(msg) {
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += `${new Date().toLocaleTimeString()}: ${msg}<br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        async function runAutoTest() {
            log('开始自动测试...');
            
            // 测试API
            try {
                log('测试API连接...');
                const response = await fetch('http://localhost:3001/api/cognitive/archaeology', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        content: '自动测试消息',
                        sessionId: null,
                        history: []
                    })
                });
                
                const data = await response.json();
                log('API响应: ' + data.response);
                log('节点数: ' + (data.cognitiveNodes?.length || 0));
                log('✅ API测试成功');
            } catch (error) {
                log('❌ API测试失败: ' + error.message);
            }
        }
    </script>
</body>
</html>