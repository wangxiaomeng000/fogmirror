
> backend@1.0.0 dev
> nodemon --exec ts-node src/server.ts

[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): src/**/*[39m
[33m[nodemon] watching extensions: ts,json[39m
[32m[nodemon] starting `ts-node src/server.ts`[39m
[dotenv@17.2.1] injecting env (13) from .env -- tip: âš™ï¸  specify custom .env file path with { path: '/custom/path/.env' }

=== AIæœåŠ¡é…ç½® ===
AI_SERVICE_TYPE: gemini
OPENROUTER_API_KEY: å·²è®¾ç½®
GEMINI_API_KEY: å·²è®¾ç½®
å½“å‰å·¥ä½œç›®å½•: /Users/mac/Documents/GitHub/ai-emotional-support-chat/backend
.envæ–‡ä»¶è·¯å¾„: /Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/.env
==================

âœ… Connected to MongoDB
Server is running on port 3001

========== è·å–å½“å‰AIæœåŠ¡ ==========
ç¯å¢ƒå˜é‡ AI_SERVICE_TYPE: gemini
ç¯å¢ƒå˜é‡ OPENROUTER_API_KEY å­˜åœ¨? true
ç¯å¢ƒå˜é‡ GEMINI_API_KEY å­˜åœ¨? true
æœ€ç»ˆå†³å®šçš„æœåŠ¡ç±»å‹: gemini
å½“å‰ç¼“å­˜çš„æœåŠ¡: []

åˆ›å»ºAIæœåŠ¡: gemini



âœ…âœ…âœ… GEMINIæœåŠ¡å·²åˆå§‹åŒ–ï¼Œå°†ä½¿ç”¨çœŸå®å›¾ç‰‡è¯†åˆ« âœ…âœ…âœ…


âœ… æˆåŠŸåˆ›å»ºå¹¶ç¼“å­˜æœåŠ¡: gemini
è¿”å›çš„æœåŠ¡åç§°: gemini
========== ç»“æŸè·å–AIæœåŠ¡ ==========


ä½¿ç”¨çš„AIæœåŠ¡: gemini

GeminiService: å¼€å§‹åˆ†ææ¶ˆæ¯, æœ‰å›¾ç‰‡: true
å›¾ç‰‡åˆ†æå¤±è´¥: TypeError: fetch failed
    at node:internal/deps/undici/undici:15482:13
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async makeRequest (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/node_modules/@google/generative-ai/dist/index.js:397:20)
    at async generateContent (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/node_modules/@google/generative-ai/dist/index.js:867:22)
    at async GeminiService.analyzeMessage (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/src/services/ai/geminiService.ts:27:33)
    at async sendMessage (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/src/controllers/chat.controller.ts:57:36)
Gemini API error: TypeError: fetch failed
    at node:internal/deps/undici/undici:15482:13
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async makeRequest (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/node_modules/@google/generative-ai/dist/index.js:397:20)
    at async generateContent (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/node_modules/@google/generative-ai/dist/index.js:867:22)
    at async GeminiService.analyzeMessage (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/src/services/ai/geminiService.ts:65:22)
    at async sendMessage (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/src/controllers/chat.controller.ts:57:36)
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `ts-node src/server.ts`[39m
[dotenv@17.2.1] injecting env (13) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

=== AIæœåŠ¡é…ç½® ===
AI_SERVICE_TYPE: gemini
OPENROUTER_API_KEY: å·²è®¾ç½®
GEMINI_API_KEY: å·²è®¾ç½®
å½“å‰å·¥ä½œç›®å½•: /Users/mac/Documents/GitHub/ai-emotional-support-chat/backend
.envæ–‡ä»¶è·¯å¾„: /Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/.env
==================

âœ… Connected to MongoDB
Server is running on port 3001
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `ts-node src/server.ts`[39m
[dotenv@17.2.1] injecting env (13) from .env -- tip: ğŸ“¡ version env with Radar: https://dotenvx.com/radar

=== AIæœåŠ¡é…ç½® ===
AI_SERVICE_TYPE: gemini
OPENROUTER_API_KEY: å·²è®¾ç½®
GEMINI_API_KEY: å·²è®¾ç½®
å½“å‰å·¥ä½œç›®å½•: /Users/mac/Documents/GitHub/ai-emotional-support-chat/backend
.envæ–‡ä»¶è·¯å¾„: /Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/.env
==================

âœ… Connected to MongoDB
Server is running on port 3001
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `ts-node src/server.ts`[39m
[dotenv@17.2.1] injecting env (13) from .env -- tip: ğŸ” prevent committing .env to code: https://dotenvx.com/precommit

=== AIæœåŠ¡é…ç½® ===
AI_SERVICE_TYPE: gemini
OPENROUTER_API_KEY: å·²è®¾ç½®
GEMINI_API_KEY: å·²è®¾ç½®
å½“å‰å·¥ä½œç›®å½•: /Users/mac/Documents/GitHub/ai-emotional-support-chat/backend
.envæ–‡ä»¶è·¯å¾„: /Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/.env
==================

âœ… Connected to MongoDB
Server is running on port 3001

========== è·å–å½“å‰AIæœåŠ¡ ==========
ç¯å¢ƒå˜é‡ AI_SERVICE_TYPE: gemini
ç¯å¢ƒå˜é‡ OPENROUTER_API_KEY å­˜åœ¨? true
ç¯å¢ƒå˜é‡ GEMINI_API_KEY å­˜åœ¨? true
æœ€ç»ˆå†³å®šçš„æœåŠ¡ç±»å‹: gemini
å½“å‰ç¼“å­˜çš„æœåŠ¡: []

åˆ›å»ºAIæœåŠ¡: gemini



âœ…âœ…âœ… GEMINIæœåŠ¡å·²åˆå§‹åŒ–ï¼Œå°†ä½¿ç”¨çœŸå®å›¾ç‰‡è¯†åˆ« âœ…âœ…âœ…


âœ… æˆåŠŸåˆ›å»ºå¹¶ç¼“å­˜æœåŠ¡: gemini
è¿”å›çš„æœåŠ¡åç§°: gemini
========== ç»“æŸè·å–AIæœåŠ¡ ==========


ä½¿ç”¨çš„AIæœåŠ¡: gemini

GeminiService: å¼€å§‹åˆ†ææ¶ˆæ¯, æœ‰å›¾ç‰‡: true
å›¾ç‰‡åˆ†æå¤±è´¥: TypeError: fetch failed
    at node:internal/deps/undici/undici:15482:13
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async makeRequest (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/node_modules/@google/generative-ai/dist/index.js:397:20)
    at async generateContent (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/node_modules/@google/generative-ai/dist/index.js:867:22)
    at async GeminiService.analyzeMessage (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/src/services/ai/geminiService.ts:27:33)
    at async sendMessage (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/src/controllers/chat.controller.ts:57:36)
Gemini API error: TypeError: fetch failed
    at node:internal/deps/undici/undici:15482:13
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async makeRequest (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/node_modules/@google/generative-ai/dist/index.js:397:20)
    at async generateContent (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/node_modules/@google/generative-ai/dist/index.js:867:22)
    at async GeminiService.analyzeMessage (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/src/services/ai/geminiService.ts:65:22)
    at async sendMessage (/Users/mac/Documents/GitHub/ai-emotional-support-chat/backend/src/controllers/chat.controller.ts:57:36)
